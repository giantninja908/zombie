<html>
  <head>
    <title>Zombies</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <canvas id="canvas" width="500" height="500" style="border:2px solid black;"/>
    <script>
      function fullScreen()
      {
        // check if user allows full screen of elements. This can be enabled or disabled in browser config. By default its enabled.
        //its also used to check if browser supports full screen api.
        if("fullscreenEnabled" in document || "webkitFullscreenEnabled" in document || "mozFullScreenEnabled" in document || "msFullscreenEnabled" in document) 
        {
          if(document.fullscreenEnabled || document.webkitFullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled)
          {


            var element = document.getElementById("canvas")
            //requestFullscreen is used to display an element in full screen mode.
            if("requestFullscreen" in element) 
            {
              element.requestFullscreen();
            } 
            else if ("webkitRequestFullscreen" in element) 
            {
              element.webkitRequestFullscreen();
            } 
            else if ("mozRequestFullScreen" in element) 
            {
              element.mozRequestFullScreen();
            } 
            else if ("msRequestFullscreen" in element) 
            {
              element.msRequestFullscreen();
            }




          }
        }
        else
        {
          alert("Y U NO GET FULLSCREEN!?!?!")
        }
      }
      try{
      console.clear()
      var canvas = document.getElementById("canvas");
      var ctx = canvas.getContext("2d");

      var plr = 490;
      var x = 250;
      var v = 0;
      var h = 0;
      var keys = {
        a: false,
        d: false
      }
      
      function map(value, low1, high1, low2, high2) {
        return low2 + (high2 - low2) * (value - low1) / (high1 - low1);
      }
      
      function zomb(){
        this.y = 490
        this.j = 0
        this.health = 10
        if(Math.random()>0.5){
          this.x = 500
        }else{
          this.x = -10
        }
        
                       
        
        this.update = function(){
          if(((Math.floor(Math.random()*100)==Math.floor(Math.random()*100)))&&this.y==490){
            this.j = -3
          }
          this.j+=0.3
          this.y+=this.j
          if(this.y>490){
            this.y = 490
          }
          
          ctx.fillStyle = "rgb(247, 49, 224)"
          ctx.fillRect(this.x+2,this.y-2,6,2)
          ctx.fillStyle = "green"
          ctx.fillRect(this.x,this.y,10,10)
          ctx.fillStyle = "black"

          if(this.x<x){
            this.x++
            ctx.fillRect(this.x+5,this.y+2,3,3)
          }else
            if(this.x>x){
              this.x--
              ctx.fillRect(this.x+1,this.y+2,3,3)
            }else{
              ctx.fillRect(this.x+5,this.y+2,3,3)
              ctx.fillRect(this.x+1,this.y+2,3,3)
            }
        }
      }


      var zombs = [new zomb()]
      var time = 0
      var health = 100
      var dir = "left"
      var lvl = 1
      var sec = 0
      function reset(){
        plr = 490;
        x = 250;
        v = 0;
        h = 0;
        keys = {
          a: false,
          d: false
        }
        zombs = [new zomb()]
        time = 0
        health = 100
        dir = "left"
        sec = 0
      }
      ctx.textAlign = "center"
      ctx.font = "40px Ariel"
      setInterval(function(){
        time++

        ctx.clearRect(0,0,500,500);
        //Somethi

        ctx.fillStyle = "black"
        ctx.fillText(15-sec,250,60)
        ctx.fillRect(x,plr,10,10);
        ctx.textAlign = "left"
        ctx.fillText("Lvl "+lvl, 0,40)
        
        ctx.fillStyle = "white"
        if(dir == "left"){
          ctx.fillRect(x+1,plr+2,3,3)
        }else{
          ctx.fillRect(x+5,plr+2,3,3)
        }
        ctx.fillStyle = "rgb("+(256-((health/2)*(256/50)))+","+((health/2*(256/50)))+",0)"
        ctx.fillRect(x+(100-health)/4-20,plr-20,health/2,10)
        v+=0.3
        plr+=v
        h*=0.9
        x+=h
        if(plr >490){
          plr = 490
        }
        if(keys.a){
          h += -1
        }
        if(keys.d){
          h += 1
        }
        for(var i = 0; i<zombs.length;i++){
          zombs[i].update()
          if (x < zombs[i].x + 10 &&
              x + 10 > zombs[i].x &&
              plr < zombs[i].y + 10 &&
              plr + 10 > zombs[i].y) {
            // collision detected!
            health--
            if(health == 0){
              reset()
            }
          }
        }
        if(time%(map(lvl,1,2,60,50))==0){
          
          zombs[zombs.length] = new zomb()
        }
        if(time%60 == 0){
          sec++
          if(sec == 15){
            lvl++
            reset()
          }
        }
        if(x<0){
          x=0
        }
        if(x>490){
          x=490
        }
      },1000/60);


      document.onkeydown = function(e){
        let res = String.fromCharCode(e.keyCode);
        if(((res=="W")||(res=="&"))&& plr == 490){
          v = -7;
        }
        if(res == "A"||res == "%"){
          keys.a = true
          dir = "left"
        }
        if(res == "D"||res == "'"){
          keys.d = true
          dir =  "right"
        }
        if(res == "F"){
          fullScreen()
        }
      }

      document.onkeyup = function(e){
        let res = String.fromCharCode(e.keyCode)
        
        if(res == "A"||res == "%"){
          keys.a = false
        }
        if(res == "D"||res == "'"){
          keys.d = false
        }
      }
      window.onerror = function(e){
        
      }
      }catch(e){
        document.write(e)
      }
    </script>
  </body>
</html>
